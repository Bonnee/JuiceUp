extends layout.pug

block head
  title= "KeContact"

block nav
  div.d-flex.flex-row.mt-2.mt-sm-0
    form.mr-0.mr-sm-2.w-100(onsubmit="return false")
      div.input-group
        div.input-group-prepend
          span.input-group-text|â‚¬/kWh
        input#priceIn.form-control(type="number" step="0.01" aria-label="Amount (to the nearest dollar)" value=price)
        div.input-group-append
          input#setPrice.btn.btn-primary(type="submit" value="Set")
      
    button.btn.btn-primary.d-none.d-sm-block(data-toggle="modal" data-target="#addWallbox")|New

block content
  div.row
    each box in boxes
      a.custom-card(href='/'+box.serial+'/meter')
        div.card.col.col-sm-6.col-md-4.col-lg-3.mx-3.mx-sm-0.d-inline-block
          img.card-img-top(src='/p20.png')
          div.card-body
            h5.card-title=box.name+' '
              span.badge.badge-primary.float-right=box.product.split('-')[1]
            div.card-text|Address #{box.address}
            div.card-text
              a.btn.btn-sm.btn-primary(href='/'+box.serial+'/meter')
                i.fas.fa-tachometer-alt
              a.btn.btn-sm.btn-primary(href='/'+box.serial+'/history')
                i.fas.fa-history

            div.card-text
              small.text-muted|Serial No. #{box.serial}<br/>
    
block footer
  include includes/addWallboxModal.pug
  script.
      $("#setPrice").click(() => {
        $.post("/price", { price: $("#priceIn").val() }, (data) => {
          $("#priceIn").val(parseFloat(data));
        });
      });
