extends layout.pug

block head
  title= "KeContact"

block nav
  div.d-flex.flex-row.mt-2.mt-sm-0
    form.mr-0.mr-sm-2.w-100(onsubmit="return false")
      div.input-group
        div.input-group-prepend
          span.input-group-text|â‚¬/kWh
        input#priceIn.form-control(type="number" step="0.01" aria-label="Amount (to the nearest dollar)" value=price)
        div.input-group-append
          input#setPrice.btn.btn-primary(type="submit" value="Set")
      
    button.btn.btn-primary.d-none.d-sm-block(data-toggle="modal" data-target="#addWallbox")|New

block content
  div.row
    each box in boxes
      div.col.col-sm-6.col-md-4.col-lg-3
        div.card.mx-3.mx-sm-0
          a.text-dark(href='/'+box.serial+'/meter' style='text-decoration: none;')
            div.card-body.pb-1
              h5.card-title=box.name
                span.badge.badge-primary.float-right=box.product.split('-')[1]
            img.card-img-top(src='/p20.png')
          
          div.card-body.pt-2
            div.card-text
              small.text-muted|S/N: #{box.serial}
              span.float-right
                a.card-link(href='/'+box.serial+'/meter' data-toggle="tooltip" data-placement="bottom" title="Meter")
                  i.fas.fa-tachometer-alt
                a.card-link(href='/'+box.serial+'/history' data-toggle="tooltip" data-placement="bottom" title="History")
                  i.fas.fa-history
    
block footer
  include includes/addWallboxModal.pug
  script.
      $("#setPrice").click(() => {
        $.post("/api/price", { price: $("#priceIn").val() }, (data) => {
          $("#priceIn").val(parseFloat(data));
        });
      });
      $(function () {
        $('[data-toggle="tooltip"]').tooltip()
      });
